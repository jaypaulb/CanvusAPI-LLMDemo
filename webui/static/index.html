<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CanvusLocalLLM Dashboard</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-brand">
                <h1 class="header-title">CanvusLocalLLM</h1>
                <span class="header-subtitle">AI Integration Dashboard</span>
            </div>
            <div class="header-status">
                <span id="connection-status" class="status-indicator status-connecting">
                    <span class="status-dot"></span>
                    <span class="status-text">Connecting...</span>
                </span>
                <span id="version-info" class="version-info"></span>
            </div>
        </header>

        <!-- Main Content Grid -->
        <main class="dashboard-main">
            <!-- Row 1: Status Cards -->
            <section class="status-row">
                <!-- System Status Widget -->
                <div class="widget widget-status" id="system-status-widget">
                    <div class="widget-header">
                        <h2 class="widget-title">System Status</h2>
                        <span class="widget-badge" id="system-health-badge">--</span>
                    </div>
                    <div class="widget-content">
                        <div class="status-grid">
                            <div class="status-item">
                                <span class="status-label">Health</span>
                                <span class="status-value" id="system-health">--</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Uptime</span>
                                <span class="status-value" id="system-uptime">--</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">GPU Available</span>
                                <span class="status-value" id="gpu-available">--</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Last Check</span>
                                <span class="status-value" id="last-check">--</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- GPU Metrics Widget -->
                <div class="widget widget-gpu" id="gpu-metrics-widget">
                    <div class="widget-header">
                        <h2 class="widget-title">GPU Metrics</h2>
                        <span class="widget-badge" id="gpu-status-badge">--</span>
                    </div>
                    <div class="widget-content">
                        <div class="gpu-info">
                            <div class="gpu-name" id="gpu-name">No GPU detected</div>
                            <div class="gpu-driver" id="gpu-driver">--</div>
                        </div>
                        <div class="gpu-metrics-grid">
                            <div class="metric-card">
                                <div class="metric-label">Utilization</div>
                                <div class="metric-value" id="gpu-utilization">--%</div>
                                <div class="metric-bar">
                                    <div class="metric-bar-fill" id="gpu-utilization-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">Memory</div>
                                <div class="metric-value" id="gpu-memory">-- / -- MB</div>
                                <div class="metric-bar">
                                    <div class="metric-bar-fill" id="gpu-memory-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">Temperature</div>
                                <div class="metric-value" id="gpu-temperature">--Â°C</div>
                                <div class="metric-bar metric-bar-temp">
                                    <div class="metric-bar-fill" id="gpu-temperature-bar" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">Power</div>
                                <div class="metric-value" id="gpu-power">-- / -- W</div>
                                <div class="metric-bar">
                                    <div class="metric-bar-fill" id="gpu-power-bar" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        <!-- GPU Utilization Chart Container -->
                        <div class="gpu-chart-container" id="gpu-chart-container">
                            <canvas id="gpu-chart" width="400" height="120"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Canvas Status Widget -->
                <div class="widget widget-canvases" id="canvas-status-widget">
                    <div class="widget-header">
                        <h2 class="widget-title">Canvas Status</h2>
                        <span class="widget-badge" id="canvas-count-badge">0</span>
                    </div>
                    <div class="widget-content">
                        <div class="canvas-list" id="canvas-list">
                            <div class="empty-state">No canvases connected</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Row 2: Metrics and Activity -->
            <section class="metrics-row">
                <!-- Processing Metrics Panel -->
                <div class="widget widget-metrics" id="processing-metrics-widget">
                    <div class="widget-header">
                        <h2 class="widget-title">Processing Metrics</h2>
                    </div>
                    <div class="widget-content">
                        <div class="metrics-summary">
                            <div class="metric-big">
                                <div class="metric-big-value" id="total-processed">0</div>
                                <div class="metric-big-label">Total Processed</div>
                            </div>
                            <div class="metric-big metric-success">
                                <div class="metric-big-value" id="total-success">0</div>
                                <div class="metric-big-label">Successful</div>
                            </div>
                            <div class="metric-big metric-error">
                                <div class="metric-big-value" id="total-errors">0</div>
                                <div class="metric-big-label">Errors</div>
                            </div>
                            <div class="metric-big">
                                <div class="metric-big-value" id="success-rate">0%</div>
                                <div class="metric-big-label">Success Rate</div>
                            </div>
                        </div>
                        <div class="metrics-by-type" id="metrics-by-type">
                            <!-- Populated dynamically -->
                        </div>
                    </div>
                </div>

                <!-- Active Queue Panel -->
                <div class="widget widget-queue" id="active-queue-widget">
                    <div class="widget-header">
                        <h2 class="widget-title">Active Queue</h2>
                        <span class="widget-badge" id="queue-count-badge">0</span>
                    </div>
                    <div class="widget-content">
                        <div class="queue-list" id="queue-list">
                            <div class="empty-state">No tasks in queue</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Row 3: Recent Activity Log -->
            <section class="activity-row">
                <div class="widget widget-activity" id="activity-log-widget">
                    <div class="widget-header">
                        <h2 class="widget-title">Recent Activity</h2>
                        <div class="widget-controls">
                            <button class="btn btn-sm" id="clear-activity-btn">Clear</button>
                            <select id="activity-filter" class="select-sm">
                                <option value="all">All Types</option>
                                <option value="ai">AI Prompts</option>
                                <option value="pdf">PDF Analysis</option>
                                <option value="ocr">OCR</option>
                                <option value="image">Image Gen</option>
                                <option value="canvas">Canvas Analysis</option>
                            </select>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="activity-table-container">
                            <table class="activity-table">
                                <thead>
                                    <tr>
                                        <th class="col-time">Time</th>
                                        <th class="col-type">Type</th>
                                        <th class="col-canvas">Canvas</th>
                                        <th class="col-status">Status</th>
                                        <th class="col-duration">Duration</th>
                                        <th class="col-details">Details</th>
                                    </tr>
                                </thead>
                                <tbody id="activity-log">
                                    <tr class="empty-row">
                                        <td colspan="6" class="empty-state">No recent activity</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="dashboard-footer">
            <div class="footer-left">
                <span id="footer-status">Disconnected</span>
            </div>
            <div class="footer-right">
                <span id="footer-version">CanvusLocalLLM</span>
                <span class="footer-separator">|</span>
                <span id="footer-time"></span>
            </div>
        </footer>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="/static/js/websocket.js"></script>
    <script src="/static/js/dashboard.js"></script>
</body>
</html>
